var angular=require("angular"),inflection=require("inflection");require("angular-route"),require("angular-animate"),require("nginflection"),require("ui-select"),require("angular-sanitize"),require("angular-ui-bootstrap"),require("chart.js"),require("./controller"),require("./directive"),require("./service"),require("./components"),require("./filters"),angular.module("sescstafftools",["ngRoute","ngInflection","ngAnimate","ui.select","ui.bootstrap","ngSanitize","sescst-utils","main-controller","sescst-structure","helper-services","utility-services","sescst-forms","app-filters","sescst-posts","sescst-app-settings","reports-services","sescst-report-builder"]).constant("config",{dateFormat:"MMM d, y",dateOffset:"+0500"}).config(["$interpolateProvider",function(e){e.startSymbol("{["),e.endSymbol("]}")}]).config(["uiSelectConfig",function(e){e.theme="select2",e.resetSearchInput=!0,e.appendToBody=!0}]).config(require("./components/routes")),module.exports=angular.module("sescst-forms",[]).controller("formCtrl",require("../controller/formCtrl")).directive("formInclude",require("../directive/forms/formInclude")).directive("formField",require("../directive/forms/formField")).directive("hideshowpass",require("../directive/forms/hideShowPassword")).directive("focusMe",require("../directive/forms/focusField")).directive("multiSelectChecker",require("../directive/forms/multiSelectChecker")).directive("select2Field",require("../directive/forms/select2Field")).directive("datePickerField",require("../directive/forms/datePickerField")).directive("repeater",require("../directive/forms/repeater")).directive("simpleRepeaterForm",require("../directive/forms/simpleRepeaterForm")).directive("complexRepeaterField",require("../directive/forms/complexRepeaterField")),require("./utils"),require("./structure"),require("./forms"),require("./posts"),require("./settings"),require("./reports"),module.exports=angular.module("sescst-posts",[]).controller("PostCtrl",require("../controller/posts/postCtrl")).controller("ActivityLogFormCtrl",require("../controller/posts/activityLogFormCtrl")).directive("postfield",require("../directive/posts/postField")),module.exports=angular.module("sescst-report-builder",[]).controller("reportBuilderCtrl",require("../controller/reportBuilderCtrl")).directive("formFilters",require("../directive/reports/formFilters")).directive("reportWidget",require("../directive/reports/reportWidget")).directive("filterSelect",require("../directive/reports/filterSelect")).directive("metricSelect",require("../directive/reports/metricSelect")).directive("reportTable",require("../directive/reports/reportTable")).directive("chartMetrics",require("../directive/reports/chartMetrics")),module.exports=["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"../templates/staff-tools-index.html",controller:require("../controller/mainCtrl")}).when("/posts",{templateUrl:"../templates/post-list.html",controller:require("../controller/posts/postListCtrl")}).when("/post",{templateUrl:"../templates/single-post.html",controller:"PostCtrl"}).when("/confirm",{templateUrl:"../templates/confirm.html",controller:require("../controller/confirmCtrl")})}],module.exports=angular.module("sescst-app-settings",[]).controller("appSettingsCtrl",require("../controller/appSettingsCtrl")),module.exports=angular.module("sescst-structure",[]).directive("sidebar",require("../directive/structure/sescSidebarDiv")).directive("main",require("../directive/structure/sescMainDiv")).controller("sescHeaderCtrl",require("../controller/structure/sescHeaderCtrl")).controller("sescSidebarCtrl",require("../controller/structure/sescSidebarCtrl")).controller("sescFooterCtrl",require("../controller/structure/sescFooterCtrl")),module.exports=angular.module("sescst-utils",[]).directive("jsonText",require("../directive/utils/jsonText")).directive("dynamicElement",require("../directive/utils/dynamicElement")).directive("staticInclude",require("../directive/utils/staticInclude")),module.exports=["$scope","$http","$log","$window","helpers","$location","$timeout","$q",function(e,t,r,i,o,l,n,a){e.changeSettingPanel=function(t){e.curPanel=t,l.url(t)},e.curAppSettings={},o.getPosts("AppSettings","",function(t){if(t)for(var r=0,i=t.length;i>r;r++)e.curAppSettings[t[r].setting_name]=t[r].setting_val,o.isJson(t[r].setting_val)&&(e.curAppSettings[t[r].setting_name]=JSON.parse(t[r].setting_val))}),e.getAppSettings=function(e,t){var r=a.defer();return o.getPosts(e,"",function(e){if(e){for(var i,o=[],l=0,n=e.length;n>l;l++){i={};for(var a=0,s=t.length;s>a;a++)i[t[a]]=e[l][t[a]];o.push(i)}r.resolve(o)}}),r.promise},e.getAppSettings("Role",["name","description"]).then(function(t){e.curRoles=t}),e.getAppSettings("Activity_Type",["name","description"]).then(function(t){e.curActivityTypes=t}),e.getAppSettings("Activity_Topic",["name","description"]).then(function(t){e.curActivityTopics=t}),e.getAppSettings("Activity_Scope",["name","description"]).then(function(t){e.curActivityScopes=t}),e.getAppSettings("Delivery_Method",["name","description"]).then(function(t){e.curDeliveryMethods=t}),e.getAppSettings("School_Designation",["name","description"]).then(function(t){e.curSchoolDesignations=t}),e.getAppSettings("Work_Day",["name","description"]).then(function(t){e.curWorkDays=t}),e.getAppSettings("School_Type",["name"]).then(function(t){e.curSchoolTypes=t}),e.getAppSettings("School_Level",["name"]).then(function(t){e.curSchoolLevels=t}),e.getAppSettings("Location_Service",["name"]).then(function(t){e.curDistrictSchoolServices=t}),e.saveAppSettings=function(){r.log("Settings Saved!"),t.post("/api/save_app_settings",{roles:JSON.stringify(e.curRoles.field_rows),activity_types:JSON.stringify(e.curActivityTypes.field_rows),activity_topics:JSON.stringify(e.curActivityTopics.field_rows),activity_scope:JSON.stringify(e.curActivityScopes.field_rows),delivery_methods:JSON.stringify(e.curDeliveryMethods.field_rows),school_designations:JSON.stringify(e.curSchoolDesignations.field_rows),work_days:JSON.stringify(e.curWorkDays.field_rows),school_types:JSON.stringify(e.curSchoolTypes.field_rows),school_levels:JSON.stringify(e.curSchoolLevels.field_rows),location_services:JSON.stringify(e.curDistrictSchoolServices.field_rows),mileage_reimbursement:JSON.stringify(e.curAppSettings.mileage_reimbursement),cell_reimbursement:JSON.stringify(e.curAppSettings.cell_reimbursement),global_data_links:JSON.stringify(e.curAppSettings.global_data_links)}).then(function(e){i.location.href=e,i.location.reload()},function(e){r.log(e)})}}],module.exports=["$scope","$routeParams","$http","$log","$filter","helpers","$window","modalService",function(e,t,r,i,o,l,n,a){e.postType=t.post_type,e.postID=t.post_id,e.deleteRelType=t.delete_rel_type,e.deleteRelID=t.delete_rel_id,e.deleteRelMsg=t.delete_rel_msg;var s=t.action_url,p=t.action_callback;e.redirect=function(e){n.location.href=e,n.location.reload()},e.deleteRelConfirm=function(){var t={closeButtonText:"No",actionButtonText:"Yes",headerText:"Delete Corresponding "+o("underscoreless")(e.deleteRelType)+"?",bodyText:e.deleteRelMsg};a.showModal({},t).then(function(t){r.post("/api/delete_post",{post_type:e.deleteRelType,post_id:e.deleteRelID}).then(function(t){e.redirect(t.data)},function(e){i.log(e)})},function(){e.redirect("/#/posts?post_type="+e.postType)})},e.confirm=function(){r.post(s,{post_type:e.postType,post_id:e.postID}).then(function(t){e[p](t.data)},function(e){i.log(e)})},e.cancel=function(){window.history.back()}}],module.exports=["$scope","$log",function(e,t){e.passwordInputType="password"}],module.exports=angular.module("main-controller",[]).controller("mainCtrl",require("./mainCtrl")),module.exports=["$scope","$routeParams","$http","$log","$rootScope","$location","helpers","$timeout",function(e,t,r,i,o,l,n,a){a(function(){$(".alert").fadeOut("fast")},6e3),n.getPosts("AppSettings","",function(t){e.globalSettings={};for(var r=0,i=t.length;i>r;r++)"string"==typeof t[r].setting_val&&n.isJson(t[r].setting_val)?e.globalSettings[t[r].setting_name]=JSON.parse(t[r].setting_val):e.globalSettings[t[r].setting_name]=t[r].setting_val}),n.getCurrentUser(function(t){e.curUser=t})}],module.exports=["$scope","$routeParams",function(e,t){}],module.exports=["$scope","$log","$routeParams","ReportUtils","$location","$window","helpers","$q","$controller","$filter",function(e,t,r,i,o,l,n,a,s,p){angular.extend(this,s("mainCtrl",{$scope:e})),e.curDate=new Date,e.saveBtnText="Save Report",e.saveReport=i.saveReport,e.deleteReport=i.deleteReport,e.filter_date_range=[0,new Date],e.reportFilters=[],e.reportFilter="",e.reportTypeOptions=[{label:"Activity Report",value:"activity"},{label:"Expense Report",value:"expense"}],e.activityReportPresets=[{label:"KDE Activity Log Report",value:"general"},{label:"District Activity Report",value:"district"},{label:"Consultant Activity Report",value:"user"}],e.expenseReportPresets=[{label:"General Expense Report",value:"general"},{label:"District Expense Report",value:"district"},{label:"Consultant Expense Report",value:"user"}],e.widgetOptions=[{label:"Pie Chart",value:"pie"},{label:"Bar Graph",value:"bar"},{label:"Data Table",value:"table"}],e.reportFilterOpts=[{label:"Date Range",value:"date_range"},{label:"User",value:"user"},{label:"Activity",value:"activity_type"},{label:"District",value:"district"}],e.widgetXMetricOpts=[{label:"Users",value:"user"},{label:"Districts",value:"districts"},{label:"Schools",value:"schools"},{label:"Activity Types",value:"activity_types"}],e.widgetYMetricOpts={activity:[{label:"Total Time Spent",value:"time_spent"}],expense:[{label:"Total Time Spent",value:"time_spent"},{label:"Total Expenses",value:"total_expenses"}]};var d=function(t){return{id:"filter"+t,filterSelect:e.reportFilterOpts[0]}},u=function(e,t){if(e){for(var r,i=[],o=0,l=e.length;l>o;o++)r={},r.name=e[o].name,r.value=e[o].id,i.push(r);t(i)}};e.setupRBData=function(){function t(t){e.allUsers=t.users,e.allDistricts=t.districts,e.allActivities=t.activities,e.reportFilters.push(d(1))}var r={users:n.getDeferredPosts("User","",u),districts:n.getDeferredPosts("District","",u),activities:n.getDeferredPosts("Activity_Type","",u)};a.all(r).then(t)},e.addReportFilter=function(){var t=e.reportFilters.length+1;e.reportFilters.push(d(t))},e.addNewWidget=function(){e.widgetTitle&&"undefined"!=typeof e.widgetTitle||(e.widgetTitle="untitled");var t=e.widgets.length+1,r=e.widgetType.value,o=e.widgetType.label;e.widgets.push({id:"widget-"+t,title:e.widgetTitle,type:r,typeLabel:o,filter:e.newWidgetFilterSelect,metrics:{x:e.newWidgetXMetricSelect,y:e.newWidgetYMetricSelect}}),i.buildReportURL(e.reportType,e.reportPreset,e.reportTitle,e.reportFilter,e.widgets),e.widgetTitle="",e.newWidgetFilterSelect={filterSelect:{},filterDetail:{}},e.newWidgetXMetricSelect="",e.newWidgetYMetricSelect=""},e.destroyWidget=function(t){if(confirm("Are you sure you want to delete this report widget?")){for(var r=0;r<e.widgets.length;r++){var o=e.widgets[r];o.id===t&&e.widgets.splice(r,1)}i.buildReportURL(e.reportType,e.reportPreset,e.reportTitle,e.reportFilter,e.widgets)}},e.sortBy=function(t){e.reverse=e.propertyName===t?!e.reverse:!1,e.propertyName=t},e.buildReport=function(t){switch(t&&(e.reportType=t.reportType,e.reportPreset=t.reportPreset,e.reportTitle=t.reportTitle,e.reportFilter=t.reportFilters,e.widgets=t.reportWidgets),e.reportType){case"expense":e.reportPostType="Expense_Sheet",r="expense_sheet_start",o="expense_sheet_end";break;case"activity":default:e.reportPostType="Activity_Log",r="activity_date_start",o="activity_date_end"}if(!t){var r,o,a="";if("undefined"!=typeof e.reportTitle&&(a=" - "+e.reportTitle),"custom"===e.reportPreset.value){var s;e.reportTitle="Custom Report"+a,e.reportFilter="[";for(var d=0,u=e.reportFilters.length;u>d;d++)s=e.reportFilters[d].filterSelect.value,"date_range"==s&&(e.filter_date_range[0]=new Date(e.reportFilters[d].reportStartDate),e.filter_date_range[1]=new Date(e.reportFilters[d].reportEndDate),e.reportFilter+=e.reportPostType+"."+r+" >= '"+n.dateToPDateTime(e.filter_date_range[0])+"', ",e.reportFilter+=e.reportPostType+"."+o+" <= '"+n.dateToPDateTime(e.filter_date_range[1])+"'"),"user"==s&&(e.reportFilter+=e.reportPostType+".user.has(id="+e.reportFilters[d].reportUser.value+")"),"district"==s&&(e.reportFilter+=e.reportPostType+".districts.any(id="+e.reportFilters[d].reportDistrict.value+")"),"activity_type"==s&&(e.reportFilter+=e.reportPostType+".activity_types.any(id="+e.reportFilters[d].reportActivity.value+")"),u-1>d&&(e.reportFilter+=", ");e.reportFilter+="]"}else e.reportTitle=e.reportPreset.label+a,e.filter_date_range[0]=new Date(e.reportStartDate),e.filter_date_range[1]=new Date(e.reportEndDate),"general"===e.reportPreset.value&&(e.reportTitle="KDE "+p("titleCase")(e.reportType)+" Report For "+p("date")(e.filter_date_range[0],"mediumDate")+" to "+p("date")(e.filter_date_range[1],"mediumDate")+a,e.reportFilter="["+e.reportPostType+"."+r+" >= '"+n.dateToPDateTime(e.filter_date_range[0])+"', "+e.reportPostType+"."+o+" <= '"+n.dateToPDateTime(e.filter_date_range[1])+"']"),"district"===e.reportPreset.value&&(e.reportTitle="District "+p("titleCase")(e.reportType)+" Report For: "+e.reportDistrict.name+a,e.reportFilter="["+e.reportPostType+".districts.any(id="+e.reportDistrict.value+"), "+e.reportPostType+"."+r+" >= '"+n.dateToPDateTime(e.filter_date_range[0])+"', "+e.reportPostType+"."+o+" <= '"+n.dateToPDateTime(e.filter_date_range[1])+"']"),"user"===e.reportPreset.value&&(n.getPostData("User",e.reportUser.value,function(t){e.reportTitle="Consultant "+p("titleCase")(e.reportType)+" Report For: "+t.first_name+" "+t.last_name+a}),e.reportFilter="["+e.reportPostType+".districts.any(id="+e.reportUser.value+"), "+e.reportPostType+"."+r+" >= '"+n.dateToPDateTime(e.filter_date_range[0])+"', "+e.reportPostType+"."+o+" <= '"+n.dateToPDateTime(e.filter_date_range[1])+"']")}n.getPosts(e.reportPostType,e.reportFilter,function(t){if(t&&(e.logs_data=t,"Expense_Sheet"===e.reportPostType))for(var r=0,i=e.logs_data.length;i>r;r++)e.logs_data[r].expense_total=n.getTotalExpenses(e.logs_data[r],e.globalSettings)}),e.reportBuilt=!0,i.buildReportURL(e.reportType,e.reportPreset,e.reportTitle,e.reportFilter,e.widgets),l.onbeforeunload=function(){return!0}},e.tableSortInit=function(t){e.reverse=!1,e.propertyName="name","activity"===t&&(e.propertyName="activity_date_start"),"expense"===t&&(e.propertyName="expense_sheet_start")},e.$watch("reportType",function(t){e.reportBuilt===!1&&("activity"===t&&(e.curPresetOptions=e.activityReportPresets),"expense"===t&&(e.curPresetOptions=e.expenseReportPresets),e.reportPreset=e.curPresetOptions[0])}),e.reportBuilderInit=function(){e.reportType=e.reportTypeOptions[0].value,e.curPresetOptions=e.activityReportPresets,e.reportPreset=e.curPresetOptions[0],e.editingReport=n.getURLParameter("edit"),e.reportBuilt=!1,e.editingReport&&(e.reportBuilt=!0),e.chartControlsOpen=!1,e.newWidgetFilterSelect={},e.newWidgetXMetricSelect="",e.newWidgetYMetricSelect="",e.widgetType=e.widgetOptions[0],e.widgets=[],e.editingReport&&(e.saveBtnText="Update Report"),e.setupRBData(),i.buildReportFromURL(e.reportFilter,e.widgets,function(t){e.buildReport(t)})}}],module.exports=["$scope","$routeParams","$http","$log","$filter","helpers",function(e,t,r,i,o,l){e.userData={},l.getPostData("User",t.id,function(t){e.userData=t})}],module.exports=angular.module("app-filters",[]).filter("keylength",function(){return function(e){if(!angular.isObject(e))throw Error("Usage of non-objects with keylength filter!!");return Object.keys(e).length}}).filter("underscoreHyphen",function(){return function(e){return e?e.replace("-","_"):void 0}}).filter("underscoreless",function(){return function(e){return e.replace(/_/g," ")}}).filter("num",function(){return function(e){return parseInt(e,10)}}).filter("parsejson",function(){return function(e){var t=JSON.parse(e);return t}}).filter("cellreimformat",["$filter","$http","$log",function(e,t,r){function i(i){if(i||0===i){if(i in o)return"function"!=typeof o[i].then?o[i]:void 0;o[i]=t.post(l,{post_type:"AppSettings",post_filter:""}).then(function(t){for(var r=t.data.posts,l=0,n=r.length;n>l;l++)if("cell_reimbursement"===r[l].setting_name){var a=100*r[l].setting_val;i==a?o[i]="Full ("+e("currency")(a/100)+"/mo)":i==.5*a?o[i]="Half ("+e("currency")(a/100*.5)+"/mo)":o[i]="No Reimbursement"}},function(e){r.log(e)})}}var o={},l="/api/get_posts";return i.$stateful=!0,i}]).filter("repeaterTotal",["$filter",function(e){return function(t,r,i,o){for(var l=0,n=t.field_rows,a=0,s=n.length;s>a;a++)for(var p=0,d=n[a].length;d>p;p++)n[a][p].field_id===r&&(l+=n[a][p].field_val);return"undefined"!=typeof i&&l>=i?"undefined"!=typeof o?e(o)(i)+" (max)":i+" (max)":"undefined"!=typeof o?e(o)(l):l}}]).filter("titleCase",function(){return function(e){return e=e||"",e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}}).filter("linksList",function(){return function(e,t,r,i){for(var o,l,n="<ul>",a=0,s=e.length;s>a;a++)o=e[a][t],l=e[a][r],i&&(o=e[a][0][t],l=e[a][1][r]),n+="<li><a href='"+l+"' title='"+o+"'  target='_blank'>"+o+"</a></li>";return n+="</ul>"}}).filter("to_trusted",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]).filter("displayFilterVal",["helpers","$filter",function(e,t){return function(e,r){var i=e;if(i=e.name,"date_range"===r.filterSelect.value){var o=new Date(e.reportStartDate),l=new Date(e.reportEndDate);i=t("date")(o)+" - "+t("date")(l)}return i}}]),require("./filters"),module.exports=angular.module("helper-services",[]).factory("helpers",["$http","$log","$q",function(e,t,r){return{getCurrentUser:function(r){e.get("/api/get_cur_user").then(function(e){r(e.data.current_user[0])},function(e){t.log(e)})},getPostID:function(r,i,o){e.post("/api/get_post_id",{post_type:r,post_name:i}).then(function(e){o(e.data.post_id)},function(e){t.log(e)})},getPostData:function(r,i,o){e.post("/api/get_post",{post_type:r,id:i}).then(function(e){o(e.data.post)},function(e){t.log(e)})},getPosts:function(r,i,o){i="undefined"!=typeof i?i:"",e.post("/api/get_posts",{post_type:r,post_filter:i}).then(function(e){o(e.data.posts)},function(e){t.log(e)})},getDeferredPosts:function(i,o,l){var n=r.defer();return e.post("/api/get_posts",{post_type:i,post_filter:o}).then(function(e){l(e.data.posts,function(e){n.resolve(e)})},function(e){t.log(e)}),n.promise},isJson:function(e){try{JSON.parse(e)}catch(t){return!1}return!0},dateToPDateTime:function(e){Number.prototype.padLeft=function(e,t){var r=String(e||10).length-String(this).length+1;return r>0?new Array(r).join(t||"0")+this:this};var t=[e.getFullYear(),(e.getMonth()+1).padLeft(),e.getDate().padLeft()].join("-")+" "+[e.getHours().padLeft(),e.getMinutes().padLeft(),e.getSeconds().padLeft()].join(":");return t},getObjByValue:function(e,t){for(var r,i=0,o=e.length;o>i;i++){r=e[i];for(var l in r)if(r.hasOwnProperty(l)&&r[l]===t)return r}},clone:function(e){if(null===e||"object"!=typeof e)return e;var t=e.constructor();for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},arrayClean:function(e,t){for(var r=0;r<e.length;r++)e[r]===t&&(e.splice(r,1),r--);return e},getURLParameter:function(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(window.location.href)||[null,""])[1].replace(/\+/g,"%20"))||null},removeURLParameter:function(e,t){var r=e.split("?");if(r.length>=2){for(var i=encodeURIComponent(t)+"=",o=r[1].split(/[&;]/g),l=o.length;l-- >0;)-1!==o[l].lastIndexOf(i,0)&&o.splice(l,1);return e=r[0]+(o.length>0?"?"+o.join("&"):"")}return e},getTotalExpenses:function(e,t){var r=0;r+=e.total_mileage*(.01*t.mileage_reimbursement);var i=[];i.push("string"==typeof e.itemized_meals?JSON.parse(e.itemized_meals):e.itemized_meals),i.push("string"==typeof e.hotel_reimbursement?JSON.parse(e.hotel_reimbursement):e.hotel_reimbursement),i.push("string"==typeof e.other_reimbursement?JSON.parse(e.other_reimbursement):e.other_reimbursement);for(var o=0,l=i.length;l>o;o++)for(var n=0,a=i[o].field_rows.length;a>n;n++)for(var s=0,p=i[o].field_rows[n].length;p>s;s++)"cost"!==i[o].field_rows[n][s].field_id&&"item_cost"!==i[o].field_rows[n][s].field_id||(r+=i[o].field_rows[n][s].field_val);return r}}}]),require("./helpers"),require("./utilities"),require("./reports"),module.exports=angular.module("reports-services",[]).factory("ReportUtils",require("./reports/reportUtilities")).service("ColorRange",require("./reports/colorrange")).service("WidgetTable",require("./reports/tables")).service("WidgetChart",require("./reports/charts")),module.exports=angular.module("utility-services",[]).service("modalService",["$uibModal",function(e){var t={backdrop:!0,keyboard:!0,modalFade:!0,templateUrl:"../templates/partials/util/modal.html"},r={closeButtonText:"Close",actionButtonText:"OK",headerText:"Proceed?",bodyText:"Perform this action?"};this.showModal=function(e,t){return e||(e={}),e.backdrop="static",this.show(e,t)},this.show=function(i,o){var l={},n={};return angular.extend(l,t,i),angular.extend(n,r,o),l.controller||(l.controller=function(e,t){e.modalOptions=n,e.modalOptions.ok=function(e){t.close(e)},e.modalOptions.close=function(e){t.dismiss("cancel")}}),e.open(l).result}}]),module.exports=["$scope","$routeParams","$http","$log","$window",function(e,t,r,i,o){e.saveActivityLog=function(e){r.post("/api/save_activity_log",{}).then(function(t){e(),i.log(t.data)},function(e){i.log(e.data)})},e.saveExpenseSheet=function(e){r.post("/api/save_expense_sheet",{}).then(function(t){e(),i.log(t.data)},function(e){i.log(e.data)})}}],module.exports=["$scope","$routeParams","$http","$log","$filter","helpers","$sce","$location",function(e,t,r,i,o,l,n,a){e.postType=t.post_type,e.postData={},e.singleTemplate="../templates/partials/single/single-"+o("dasherize")(o("lowercase")(e.postType))+".html",l.getPostData(e.postType,t.id,function(t){e.postData=t;for(var r in e.postData)e.postData.hasOwnProperty(r)&&"string"==typeof e.postData[r]&&l.isJson(e.postData[r])&&(e.postData[r]=JSON.parse(e.postData[r]));"Expense_Sheet"===e.postType&&(e.getTotalExpenses=l.getTotalExpenses)}),e.editAccess=function(t,r,i){var i="undefined"!=typeof i?i:!1;return"Administrator"===e.curUser.urole?!0:!i&&"User"===r&&t===e.curUser.id},e.deletePost=function(t,r){var i,o="",l=null,n=null;e.postData.expense_sheet&&"Activity_Log"===r&&(o="Delete Related Expense Sheet as Well?",n=e.postData.expense_sheet,l="Expense_Sheet"),e.postData.activity_log&&"Expense_Sheet"===r&&(o="Delete Related Activity Log as Well?",n=e.postData.activity_log.id,l="Activity_Log"),i=n?"deleteRelConfirm":"redirect",a.path("/confirm").search({post_id:t,post_type:r,action_url:"/api/delete_post",action_callback:i,delete_rel_type:l,delete_rel_id:n,delete_rel_msg:o})}}],module.exports=["$scope","$routeParams","$http","$log","$filter","$templateCache",function(e,t,r,i,o,l){e.postType=t.post_type,e.postFilter="undefined"!=typeof t.post_filter?t.post_filter:"",e.postFilterKey="undefined"!=typeof t.post_filter_key?t.post_filter_key:"",e.postFilterVal="undefined"!=typeof t.post_filter_val?t.post_filter_val:"",e.createPostURL="/admin/create-"+o("dasherize")(o("lowercase")(e.postType)),"Report_URL"===e.postType&&(e.createPostURL="/admin/report-builder"),r.post("/api/get_posts",{post_type:e.postType,post_filter:e.postFilter}).then(function(t){e.postList=t.data,e.getListTemplate=function(){return e.postList.posts.length?"../templates/partials/archive/posts-"+o("dasherize")(o("lowercase")(e.postType))+".html":"../templates/partials/archive/empty-results.html"}},function(e){i.log(e)})}],module.exports=["$scope","$filter","UserAuth",function(e,t,r){e.loggedIn=r.loggedIn}],module.exports=["$scope","$filter","UserAuth",function(e,t,r){e.loggedIn=r.loggedIn}],module.exports=["$scope","$filter","$location","$log",function(e,t,r,i){e.initSettingsPanel=function(){""===r.url()||"/"===r.url()?e.$parent.changeSettingPanel("access-roles"):e.$parent.changeSettingPanel(r.path().replace(/^\//,""))},e.isActive=function(e){var t=e===r.url();return t}}],module.exports=["$timeout","$parse",function(e,t){return{link:function(e,t,r){t.bind("blur",function(t){e.$apply(r.blurMe)})}}}],module.exports=["$http","$log","$timeout","$filter","config",function(e,t,r,i,o){var l="<div><label ng-if='label' for='{[ fieldName ]}'>{[ label ]}</label> 		<input id='{[ fieldName ]}' name='{[ fieldName ]}' type='text' ng-hide='true' ng-model='serializedFieldVal'> 		<table class='ui table'><thead><tr><th ng-repeat='f in fields track by $index'><strong>{[ f.field_label ]}</strong></th><th><button type='button' class='repeater-add btn btn-default' ng-click='addItem(\"{[ fieldName ]}\")' aria-label='Add Item' title='Add Item'><span class='glyphicon glyphicon-plus' aria-hidden='true'></span></button></th></tr></thead> 		<tr data-toggle='fieldset-entry' ng-repeat='i in getNumber(rows) track by $index'> 		<td ng-repeat='f in fields track by $index'> 		<form-field model='fieldModels[\"field_rows\"][$parent.$index][$index][\"field_val\"]' name='{[ fieldName ]}-{[ $parent.$index ]}-{[ f.field_id ]}' placeholder='{[ f.field_label ]}' type='{[ f.field_type ]}'></form-field> 		</td> 		<td><button ng-if='rows > 1' type='button' class='repeater-remove btn btn-default' ng-click='removeItem($parent.$index)' aria-label='Remove Item' title='Remove Item'><span class='glyphicon glyphicon-minus' aria-hidden='true'></span></button></td> 		</tr></table></div>";return{restrict:"E",replace:!0,scope:{fieldName:"@",label:"@",fields:"=",fieldModels:"=?model"},template:l,controller:["$scope",function(e){e.rows=1,e.serializedFieldVal="",e.getNumber=function(e){return new Array(e)},e.buildFieldsObj=function(t,r){var l,n,a,s,p,d,u;for(r="undefined"!=typeof r?r:{field_rows:[]},u=r.field_rows,l=0;l<e.rows;l++)for(u[l]||(u[l]=[]),n=0,a=e.fields.length;a>n;n++)s={},s.field_id=e.fields[n].field_id,s.field_type=e.fields[n].field_type,s.field_label=e.fields[n].field_label,s.filter=e.fields[n].filter,d="undefined"!=typeof u[l][n]?u[l][n].field_val:"",s.field_val=d,t&&(p=e.fields[n].filter,p&&(d="date"===p?i(p)(d,o.dateFormat,o.dateOffset):i(p)(d))),u[l][n]=s;return r},e.updateModels=function(){e.fieldModels=e.buildFieldsObj(!1,e.fieldModels),e.rows=e.fieldModels.field_rows.length},"undefined"!=typeof e.fieldModels||"undefined"==typeof e.fields?r(function(){e.updateModels()},1e3):e.updateModels(),e.$watch("fieldModels",function(t){if("undefined"!=typeof t){var r=JSON.parse(JSON.stringify(t)),i=e.buildFieldsObj(!0,r);e.serializedFieldVal=JSON.stringify(i)}},!0)}],link:function(e,t,r){e.addItem=function(){e.rows++,e.updateModels()},e.removeItem=function(t){e.fieldModels.field_rows.splice(t,1),e.rows--,e.updateModels()}}}}],module.exports=["$http","$log","$timeout","$filter",function(e,t,r,i){var o="<div class='input-group date' data-provide='datepicker'> 		<input id='{[fieldName]}' name='{[fieldName]}' type='text' class='form-control' ng-click='open()' uib-datepicker-popup='{[ format ]}' ng-model='dateInput' is-open='popup.opened' datepicker-options='dateOptions' ng-required='true' close-text='Close' alt-input-formats='altInputFormats' /> 		<span class='input-group-btn'><button type='button' class='btn btn-default' ng-click='open()'><i class='glyphicon glyphicon-calendar'></i></button></span></div>";return{restrict:"E",replace:!0,scope:{initDate:"=",model:"=",fieldName:"@"},template:o,controller:["$scope",function(e){function t(t){var r=t.date,i=t.mode;if("day"===i)for(var o=new Date(r).setHours(0,0,0,0),l=0;l<e.events.length;l++){var n=new Date(e.events[l].date).setHours(0,0,0,0);if(o===n)return e.events[l].status}return""}e.model?(e.model=new Date(e.model),e.dateInput=e.model,e.$watch("dateInput",function(t){e.model=t})):(e.initDate?e.dateInput=new Date(e.initDate):e.dateInput=new Date,e.$watch("dateInput",function(t){e.model=e.dateInput})),e.clear=function(){e.model=null},e.inlineOptions={customClass:t,minDate:new Date,showWeeks:!0},e.dateOptions={formatYear:"yy",maxDate:new Date(2020,5,22),minDate:new Date,startingDay:1},e.toggleMin=function(){e.inlineOptions.minDate=e.inlineOptions.minDate?null:new Date,e.dateOptions.minDate=e.inlineOptions.minDate},e.toggleMin(),e.open=function(){e.popup.opened=!0},e.formats=["MMM d, y","dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],e.format=e.formats[0],e.altInputFormats=["M!/d!/yyyy"],e.popup={opened:!1}}],link:function(e,t,r){}}}],module.exports=["$timeout","$parse",function(e,t){return{scope:{trigger:"@focusMe"},link:function(t,r,i){t.$watch("trigger",function(t){"true"===t&&e(function(){r[0].focus()})})}}}],module.exports=["$http","$log","$templateCache","$compile","$templateRequest","$timeout",function(e,t,r,i,o,l){return{restrict:"E",replace:!0,scope:{fieldModel:"=?model",name:"@",placeholder:"@",type:"@",autoFocus:"@",selectOptions:"=?",simpleSelect:"=?",keyVal:"=?",rows:"@"},link:function(e,t,r){"select"!==e.type&&"multiselect"!==e.type&&(e.fieldModel="undefined"!=typeof e.fieldModel?e.fieldModel:""),o("../templates/partials/forms/fields/"+e.type+".html").then(function(r){var o=angular.element(r);t.append(o),i(o)(e)})}}}],module.exports=function(){return{restrict:"E",scope:"=",template:'<ng-include src="template"/>',link:function(e,t,r){var i=r.type;e.template="../templates/partials/forms/"+i+"-form.html"}}},module.exports=function(){return{restrict:"E",replace:!0,scope:"=",templateUrl:"../templates/partials/forms/hideshow-password.html",link:function(e){e.passwordInputType="password",e.hideShowPassword=function(){"password"===e.passwordInputType?e.passwordInputType="text":e.passwordInputType="password"}}}},module.exports=["$compile",function(e){return{restrict:"A",replace:!1,terminal:!0,priority:5e4,compile:function(t,r){return t.removeAttr("multi-select-checker"),t.removeAttr("data-multi-select-checker"),{pre:function(e,t,r,i){},post:function(t,r,i,o){t.options.Multiple===!0&&r[0].setAttribute("multiple",""),e(r)(t)}}}}}],module.exports=["$http","$log","$templateCache","$compile","$templateRequest","$timeout","helpers","$filter","config",function(e,t,r,i,o,l,n,a,s){return{restrict:"E",replace:!0,scope:{fieldName:"@",label:"@",fields:"=",repeaterType:"@",inData:"=?model"},link:function(e,t,r){e.newItem=[],e.editorFlags=[],o("../templates/partials/forms/fields/"+e.repeaterType+"Repeater.html").then(function(r){var o=angular.element(r);t.append(o),i(o)(e)});var l=e.$watch("inData",function(t){var r;if("undefined"!=typeof t){if(r=t.length,t.hasOwnProperty("field_rows")&&(r=t.field_rows.length),"simple"===e.repeaterType)for(var i=0,o=r;o>i;i++)e.editorFlags.push({editing:!1});e.updateModels(t,!1),l()}else"complex"===e.repeaterType&&e.updateModels({field_rows:[""]},!1)});e.buildFieldsObj=function(t,r){var i,o,l,n,a,s,p;o="undefined"!=typeof r.field_rows?r.field_rows.length:r.length>0?r.length:1;var d={field_rows:[]};for("undefined"!=typeof e.newItem&&e.newItem.length>0&&(d="undefined"!=typeof r.field_rows?r:{field_rows:[]},o=1),i=0;o>i;i++){for(a=[],l=0,n=e.fields.length;n>l;l++)s={},s.field_id=e.fields[l].field_id,s.field_label=e.fields[l].field_label,s.field_type=e.fields[l].field_type,s.filter=e.fields[l].filter,p="undefined"!=typeof e.newItem&&e.newItem.length>0&&e.newItem[l]?e.newItem[l]:"undefined"!=typeof r.field_rows&&"undefined"!=typeof r.field_rows[i]&&"undefined"!=typeof r.field_rows[i][l]?r.field_rows[i][l].field_val:"undefined"!=typeof r[i]?r[i][e.fields[l].field_id]:"",s.field_val=p,a.push(s);d.field_rows.push(a)}return d},e.updateModels=function(t,r){e.inData=e.buildFieldsObj(r,t)},e.addItem=function(){if("complex"===e.repeaterType&&e.inData.field_rows.push({}),e.updateModels(e.inData,!1),"simple"===e.repeaterType){e.editorFlags.push({editing:!1});for(var t=0;t<e.newItem.length;t++)e.newItem[t]=""}},e.removeItem=function(t){"simple"===e.repeaterType&&e.editorFlags.splice(t,1),e.inData.field_rows.splice(t,1)},e.editItem=function(t){e.editorFlags[t].editing=!e.editorFlags[t].editing;for(var r=0,i=e.editorFlags.length;i>r;r++)r!==t&&e.editorFlags[r].editing&&(e.editorFlags[r].editing=!1);
}}}}],module.exports=["$http","$log","$timeout","helpers",function(e,t,r,i){var o="<div class='select2container'> 		<input id='{[ fieldName ]}' name='{[ fieldName ]}' type='text' ng-hide='true' ng-model='outputValue'> 		<ui-select ng-model='$parent.selectModel' multi-select-checker style='min-width: {[ minWidth ]};'> 		<ui-select-match allow-clear='true' placeholder='Select {[ label ]}'> 		<span ng-if='!multiple'>{[$select.selected[optionKey]]}</span> 		<span ng-if='multiple'>{[$item[optionKey]]}</span> 		</ui-select-match> 		<ui-select-choices repeat='item in (uiSelectOptions | filter: $select.search)' value='{[$select.selected[optionVal]]}''> 		<span ng-bind-html='item[optionKey] | highlight: $select.search'></span> 		</ui-select-choices></ui-select></div>";return{restrict:"E",scope:{selectOptions:"=",model:"=?",keyVal:"=",multiple:"=",label:"@",fieldName:"@",minWidth:"@"},template:o,controller:["$scope",function(e){e.options={},e.options.Multiple=e.multiple,"undefined"!=typeof e.keyVal&&"undefined"!=typeof e.keyVal[0]?(e.optionKey=e.keyVal[0],e.optionVal=e.keyVal[1]):e.selectOptions.only?(e.optionKey=e.selectOptions.only,e.optionVal=e.selectOptions.only):-1!==e.selectOptions.constructor.toString().indexOf("Array")?(e.optionKey=0,e.optionVal=1):(e.optionKey=e.model,e.optionVal=e.model);var t=function(t){if(e.uiSelectOptions=[],e.selectModel="",e.selectOptions.allowAll&&(e.optionsLabel="Options",e.label&&(e.optionsLabel=e.label),e.uiSelectOptions[0]={},e.uiSelectOptions[0][e.optionKey]="All "+e.optionsLabel,e.uiSelectOptions[0][e.optionVal]="all_options"),e.uiSelectOptions=e.uiSelectOptions.concat(t),e.selectOptions.only){e.model&&(e.selectModel={},e.selectModel[e.optionKey]=e.model),e.uiSelectOptions=[];for(var r=e.uiSelectOptions.length;r<t.length;r++)e.uiSelectOptions[r]={},e.uiSelectOptions[r][e.optionKey]=t[r][e.selectOptions.only],e.uiSelectOptions[r][e.optionVal]=t[r][e.selectOptions.only]}else e.model&&(e.selectModel=e.model)},r=function(t){for(var r=[],i=1;i<e.uiSelectOptions.length;i++)r.push(e.uiSelectOptions[i]),t&&r.push(e.uiSelectOptions[i][t]);return r},o=e.$watch("model",function(l){-1!=e.selectOptions.constructor.toString().indexOf("Array")?t(e.selectOptions):"object"==typeof e.selectOptions&&i.getPosts(e.selectOptions.postType,e.selectOptions.postFilter,function(e){t(e)}),e.$watch("selectModel",function(t){if(e.outputValue="","undefined"!=typeof t&&(e.selectOptions.only?(e.model=t[e.optionKey],e.outputValue=t[e.optionKey]):-1!=e.selectOptions.constructor.toString().indexOf("Array")?(e.model=t,e.outputValue=t[e.optionVal]):(e.model=t,e.outputValue=t,"object"==typeof e.outputValue&&(e.outputValue=JSON.stringify(e.outputValue))),t.constructor===Array)){var i=t.some(function(e){return"all_options"===e.id});i&&(e.selectOptions.only?(e.model=r(e.optionKey),e.outputValue=r(e.optionKey)):-1!=e.selectOptions.constructor.toString().indexOf("Array")?(e.model=r(),e.outputValue=r(e.optionVal)):(e.model=r(),e.outputValue=r(),"object"==typeof e.outputValue&&(e.outputValue=JSON.stringify(e.outputValue))))}}),o()})}],link:function(e,t,r){}}}],module.exports=["$http","$log","$templateCache","$compile","$templateRequest","$timeout","helpers",function(e,t,r,i,o,l,n){return{restrict:"E",replace:!0,scope:{inData:"=data",fieldName:"@",label:"@",fields:"="},controller:["$scope",function(e){e.$watch("inData",function(t){var r=n.clone(e.inData);"undefined"!=typeof r?e.curData=n.isJson(r)?JSON.parse(r):r:e.curData=[],e.inData=JSON.stringify(e.curData),e.newItem=[],e.editorFlags=[];for(var i=0,o=e.curData.length;o>i;i++)e.editorFlags.push({editing:!1})})}],link:function(e,t,r){o("../templates/partials/forms/fields/simpleRepeater.html").then(function(r){var o=angular.element(r);t.append(o),i(o)(e)}),e.addItem=function(){var t,r,i={};for(t=0,r=e.fields.length;r>t;t++){var o=e.fields[t].fieldName;i[o]=e.newItem[t]}e.curData.push(i),e.inData=JSON.stringify(e.curData),e.newItem=[],e.editorFlags.push({editing:!1})},e.removeItem=function(t){e.curData.splice(t,1),e.editorFlags.splice(t,1),e.inData=JSON.stringify(e.curData)},e.editItem=function(t){e.editorFlags[t].editing&&(e.inData=JSON.stringify(e.curData)),e.editorFlags[t].editing=!e.editorFlags[t].editing}}}}],module.exports=["$compile","$http","$log","$timeout","$filter","helpers","config",function(e,t,r,i,o,l,n){var a="<form class='post-field' ng-submit='savePostField()'> 		<ng-include src='fieldInclude'></ng-include> 		<div ng-show='editMode' class='edit-controls'> 		<a class='btn small btn-primary save-link' ng-click='savePostField()'>Save</a> 		<a class='btn small btn-primary cancel-link' ng-click='closeEditField()'>Cancel</a> 		</div> 		</form>";return{restrict:"E",replace:!0,scope:{fieldType:"@type",label:"@",keys:"=",adminOnly:"=",relationship:"=",isTitle:"=",inData:"=fieldData",formattedOutput:"@?",simpleSelect:"=?"},template:a,controller:["$scope",function(e){e.relation="undefined"!=typeof e.relationship?e.relationship:!1,e.editAccess=e.$parent.editAccess,e.postType=e.$parent.postType,e.postID=e.$parent.postData.id,e.editBtn="<a ng-hide='$parent.editMode' class='edit-link' ng-click='$parent.editPostField()'>Edit</a>",e.fieldInclude="../templates/partials/single/fields/"+e.fieldType+"field.html",e.editMode=!1,e.applyFilter=function(e,t){return t?o(t)(e):e},e.$watch("formattedOutput",function(t){t&&"undefined"!=typeof e.fieldData&&(e.fieldData.displayValue=t)}),e.$watch("inData",function(t){if("undefined"!=typeof t){var r=t.initValue;"repeater"===e.fieldType&&(r=t.initValue),"datetime"===e.fieldType&&(r=o("date")(t.initValue,n.dateFormat,n.dateOffset)),e.fieldData={displayValue:r,value:r,newValue:"",oldValue:null,selectOptions:e.selectOptions}}if(t&&("select"===e.fieldType||"multiselect"===e.fieldType)&&("undefined"!=typeof e.inData.selectOptions?e.selectOptions=e.inData.selectOptions:(e.optionsPostType=t.postType,e.optionsPostFilter=t.postFilter,e.optionsOnly=t.only,e.allowAllOptions=!1,t.allowAll&&(e.allowAllOptions=!0),e.selectOptions={postType:e.optionsPostType,postFilter:e.optionsPostFilter,only:e.optionsOnly,allowAll:e.allowAllOptions}),t.optionKeyVal?(e.optionKey=t.optionKeyVal[0],e.optionVal=t.optionKeyVal[1]):e.optionsOnly?(e.optionKey=e.optionsOnly,e.optionVal=e.optionsOnly):(e.optionKey=0,e.optionVal=1),e.fieldData.value&&("object"==typeof e.fieldData.value?e.fieldData.displayValue=e.fieldData.value[e.optionKey]:e.fieldData.displayValue=e.fieldData.value,"multiselect"===e.fieldType&&(e.fieldData.displayValue=[],"undefined"!=typeof e.fieldData.value))))for(var i=0;i<e.fieldData.value.length;i++)"object"==typeof e.fieldData.value[i]?e.fieldData.displayValue.push(e.fieldData.value[i][e.optionKey]):e.fieldData.displayValue.push(e.fieldData.value[i]);e.formattedOutput&&(e.fieldData.displayValue=e.formattedOutput)}),e.isArray=angular.isArray,e.testValueForArray=function(e){return angular.isArray(e)?e:[e]}}],link:function(e,o,l){e.editPostField=function(){e.fieldData.value&&"undefined"!=typeof e.fieldData.displayValue&&"undefined"!=typeof e.fieldData.value&&(e.fieldData.oldDisplayValue=e.fieldData.displayValue,-1!=e.fieldData.value.constructor.toString().indexOf("Object")?e.fieldData.oldValue=JSON.parse(JSON.stringify(e.fieldData.value)):e.fieldData.oldValue=e.fieldData.value),$("#field-save-msg").fadeOut("fast",function(){$("#field-save-msg").remove()}),e.editMode=!0},e.savePostField=function(){if(e.fieldData.newValue)e.fieldData.displayValue=e.fieldData.newValue,e.saveValue=e.fieldData.newValue,e.fieldData.newValue="";else if(e.fieldData.displayValue=e.fieldData.value,e.saveValue=e.fieldData.value,"undefined"!=typeof e.inData.selectOptions&&e.optionKey&&e.optionVal&&(e.fieldData.displayValue=e.fieldData.value[e.optionKey],e.saveValue=e.fieldData.value[e.optionVal]),e.inData.optionKeyVal&&(e.fieldData.displayValue=e.fieldData.value[e.optionKey],"multiselect"===e.fieldType)){e.fieldData.displayValue=[];for(var l=0;l<e.fieldData.value.length;l++)e.fieldData.displayValue.push(e.fieldData.value[l][e.optionKey])}e.formattedOutput&&(e.fieldData.displayValue=e.formattedOutput),e.editMode=!1,t.post("/api/save_post_field",{post_id:e.$parent.postData.id,post_type:e.$parent.postType,field_key:e.keys,field_value:e.saveValue,relationship:e.relation}).then(function(t){jQuery(o[0]).append('<span id="field-save-msg" class="success">'+t.data.success+"</span>"),e.$parent.postData[e.keys]=e.saveValue},function(e){jQuery(o[0]).append('<span id="field-save-msg" class="error">'+e.data.error+"</span>"),r.log(e.data)}),$("#field-save-msg").length>0&&i(function(){$("#field-save-msg").fadeOut("fast",function(){$("#field-save-msg").remove()})},6e3)},e.closeEditField=function(){e.fieldData.value!==e.fieldData.oldValue&&"datetime"!==e.fieldType&&(e.fieldData.displayValue=e.fieldData.oldDisplayValue,e.fieldData.value=e.fieldData.oldValue,e.fieldData.oldValue=null),e.editMode=!1},e.addItem=function(){var t=Object.keys(e.fieldData.displayValue[0]);e.fieldData.displayValue[e.fieldData.displayValue.length]={};for(var r=0;r<t.length;r++)e.fieldData.displayValue[e.fieldData.displayValue.length-1][t[r]]=""},e.removeItem=function(t){e.fieldData.displayValue.splice(t,1)}}}}],module.exports=["helpers","$log",function(e,t){return{restrict:"E",replace:!0,scope:{axis:"@",model:"=",metricOpts:"=opts"},templateUrl:"../templates/partials/reports/chart-metrics.html",controller:function(e){},link:function(e,t,r){}}}],module.exports=["$log","helpers",function(e,t){return{restrict:"E",replace:!0,templateUrl:"../templates/partials/reports/report-filter.html",link:function(e,r,i){e.filter.filterDetail={},e.$watch("filter.filterDetail",function(r){e.newWidgetFilterSelect={filterSelect:e.filter.filterSelect,filterDetail:{}},e.filter.filterDetail.hasOwnProperty("reportStartDate")&&e.filter.filterDetail.hasOwnProperty("reportEndDate")?(e.filter.filterDetail.hasOwnProperty("name")&&delete e.filter.filterDetail.name,e.filter.filterDetail.hasOwnProperty("value")&&delete e.filter.filterDetail.value,e.filter_date_range[0]=new Date(e.filter.filterDetail.reportStartDate),e.filter_date_range[1]=new Date(e.filter.filterDetail.reportEndDate),e.newWidgetFilterSelect.filterDetail.reportStartDate=t.dateToPDateTime(e.filter_date_range[0]),e.newWidgetFilterSelect.filterDetail.reportEndDate=t.dateToPDateTime(e.filter_date_range[1])):e.newWidgetFilterSelect.filterDetail=e.filter.filterDetail},!0)}}}],module.exports=[function(){var e="{{ widget.id }} - {{ widget.type }} 			<label>Filter By:</label> 			<select class='form-control' ng-options='option.value as option.name for option in widgetFilters'> 			<option>--select filter control--</option> 			</select> 			<input type='submit' class='btn btn-primary btn-sm' value='Add Another Filter' />";return{restrict:"E",replace:!0,template:e,link:function(e,t,r){}}}],module.exports=[function(){return{restrict:"E",replace:!0,templateUrl:"../templates/partials/reports/widget-metric.html",link:function(e,t,r){}}}],module.exports=["$templateRequest","$compile",function(e,t){return{restrict:"E",replace:!0,scope:{type:"@"},link:function(r,i,o){e("../templates/partials/reports/report-tables/"+r.type+".html").then(function(e){var o=angular.element(e);i.append(o),t(o)(r)})}}}],module.exports=["$timeout","WidgetTable","WidgetChart","$log","helpers","ReportUtils",function(e,t,r,i,o,l){return{restrict:"E",replace:!0,templateUrl:"../templates/partials/reports/widget-template.html",controller:function(e){e.widgetTitleEdit=!1,e.widgetTypeEdit=!1,e.metricsCollapsed=!0,e.metrics={},e.metrics.x="undefined"!==e.widget.metrics.x?e.widget.metrics.x:[e.widgetXMetricOpts[0]],e.metrics.y="undefined"!==e.widget.metrics.y?e.widget.metrics.y:[e.widgetYMetricOpts[e.$parent.reportType][0]]},link:function(i,n,a){var s=function(e){var t;switch(e){case"user":t="User";break;case"districts":t="District";break;case"schools":t="School";break;case"activity_types":t="Activity_Type";break;default:t=null}return t},p=function(){i.chartData=[];var e="",a=function(e,o){return function(a){for(var s=[],p=[],d=0,u=a.length;u>d;d++)"user"===e.value?s.push(a[d].first_name+" "+a[d].last_name):s.push(a[d].name),"time_spent"===o.value&&p.push(l.calcTimeSpent(a[d],e.value,i.$parent.logs_data));"undefined"!=typeof i.chartElem&&(n.chart&&n.chart.destroy(),"table"!==i.widget.type?n.chart=r.makeChart(i.widget.type,i.chartElem,s,p):n.chart=t.makeTable({}))}};return i.widget.metrics.x&&"undefined"!=typeof i.widget.metrics.x&&i.widget.metrics.y&&"undefined"!=typeof i.widget.metrics.y&&(metricXPT=s(i.widget.metrics.x.value),o.getPosts(metricXPT,e,a(i.widget.metrics.x,i.widget.metrics.y))),i.chartData};i.updateWidgetTitle=function(e){"save"===e?(i.widget.title=i.widgetNewTitle,l.buildReportURL(i.$parent.reportType,i.$parent.reportPreset,i.$parent.reportTitle,i.$parent.reportFilter,i.$parent.widgets)):"cancel"===e&&(i.widgetNewTitle=i.widget.title),i.widgetTitleEdit=!1},i.updateWidgetType=function(e){if("save"===e){var t=i.selectedWidgetType;i.widget.type=t.value,i.widget.typeLabel=t.label,i.updateWidget()}i.widgetTypeEdit=!1},i.updateWidget=function(){p(),l.buildReportURL(i.$parent.reportType,i.$parent.reportPreset,i.$parent.reportTitle,i.$parent.reportFilter,i.$parent.widgets)},i.compileMetricsGroup=function(e,t){var r="undefined"!=typeof e?e.length:0;if(r)for(var l=0;r>l;l++)e[l]&&"undefined"!=typeof e[l]?widgetMetricOpt=o.getObjByValue(i.widgetMetricOpts,e[l].value):widgetMetricOpt=null,t.push(widgetMetricOpt)},i.widgetInit=function(){e(function(){i.compileMetricsGroup(i.widget.metrics.x,i.metrics.x),i.compileMetricsGroup(i.widget.metrics.y,i.metrics.y),i.selectedWidgetType=o.getObjByValue(i.widgetOptions,i.widget.type),i.chartElem=document.getElementById(i.widget.id+"-"+i.widget.type),p()},300)},i.widgetInit()}}}],module.exports=function(){return{restrict:"A",replace:!0,scope:"=",templateUrl:"../templates/partials/sescst-main.html",controller:"mainCtrl"}},module.exports=["$log",function(e){return{restrict:"E",replace:!0,scope:{type:"@"},template:'<ng-include src="tpl"/>',controller:"sescSidebarCtrl",link:function(e,t,r){e.tpl="../templates/partials/sidebar/sidebar-main.html",e.type&&(e.tpl="../templates/partials/sidebar/sidebar-"+e.type+".html")}}}],module.exports=["$compile",function(e){return{restrict:"E",scope:{html:"="},replace:!0,link:function(t,r,i){var o=e(t.html)(t);r.replaceWith(o)}}}],module.exports=[function(){return{restrict:"A",require:"ngModel",link:function(e,t,r,i){function o(e){if(e&&""!==e.trim()){try{n=angular.fromJson(e),i.$setValidity("invalidJson",!0)}catch(t){i.$setValidity("invalidJson",!1)}return n}return{}}function l(e){return angular.toJson(e,!0)}var n;i.$parsers.push(o),i.$formatters.push(l),t.bind("blur",function(){t.val(l(e.$eval(r.ngModel)))}),e.$watch(r.ngModel,function(e,t){n=n||e,e!==t&&(i.$setViewValue(l(e)),i.$render())},!0)}}}],module.exports=["$templateRequest","$compile",function(e,t){return{restrict:"A",transclude:!0,replace:!0,scope:!1,link:function(r,i,o,l,n){var a=o.staticInclude;e(a).then(function(e){var o=i.html(e).contents();t(o)(r.$new(!1,r.$parent))})}}}],module.exports=["ColorRange","$log",function(e,t){var r,i,o={};return o.makeChart=function(t,o,l,n,a){var l,s,p,d=o.getContext("2d");o.width/2,o.height/2;r=e.getColorRange(l.length),"doughnut"===t||"pie"===t?(p=r,a={}):"bar"===t&&(p=r[0],a={}),s=[{data:n,backgroundColor:p}],i={labels:l,datasets:s};var u=new Chart(d,{type:t,data:i,options:a});return u},o}],module.exports=["$uibModal",function(e){function t(e,t){var o=r(e);return o.h+=t,o.h>360?o.h-=360:o.h<0&&(o.h+=360),i(o)}function r(e){e=e.replace(/^\s*#|\s*$/g,""),3==e.length&&(e=e.replace(/(.)/g,"$1$1"));var t=parseInt(e.substr(0,2),16)/255,r=parseInt(e.substr(2,2),16)/255,i=parseInt(e.substr(4,2),16)/255,o=Math.max(t,r,i),l=Math.min(t,r,i),n=o-l,a=(o+l)/2,s=0,p=0;return s=0==n?0:o==t?60*((r-i)/n%6):o==r?60*((i-t)/n+2):60*((t-r)/n+4),p=0==n?0:n/(1-Math.abs(2*a-1)),{h:s,s:p,l:a}}function i(e){var t,r,i,n=e.h,a=e.s,s=e.l,p=(1-Math.abs(2*s-1))*a,d=p*(1-Math.abs(n/60%2-1)),u=s-p/2;return 60>n?(t=p,r=d,i=0):120>n?(t=d,r=p,i=0):180>n?(t=0,r=p,i=d):240>n?(t=0,r=d,i=p):300>n?(t=d,r=0,i=p):(t=p,r=0,i=d),t=o(t,u),r=o(r,u),i=o(i,u),l(t,r,i)}function o(e,t){return e=Math.floor(255*(e+t)),0>e&&(e=0),e}function l(e,t,r){return"#"+((1<<24)+(e<<16)+(t<<8)+r).toString(16).slice(1)}var n=[];this.getColorRange=function(e){for(var r="#394894",i=0;e>i;i++)n.push(r),r=t(r,69);return n}}],module.exports=["$log","$location","$http","$window","$routeParams","helpers",function(e,t,r,i,o,l){var n=require("rison");return{buildReportURL:function(e,r,i,l,a){var a="undefined"!=typeof a?a:null,s=null;t.search("edit")&&(s=o.edit);var p=t.path(),d=p+"?";if(d+="reportType="+encodeURI(e),d+="&reportPreset="+JSON.stringify(r),d+="&reportTitle="+encodeURI(i),d+="&reportFilters="+encodeURI(l),a.length){d+="&reportWidgets=";for(var u={},c=0,f=a.length;f>c;c++)u[a[c].id]=a[c];d+=n.encode(u)+"&"}s&&(d+="&edit="+s),t.url(d)},buildReportFromURL:function(e,r,i){var o=t.search();if(Object.keys(o).length){var l,a,s,p;for(a in o)if(o.hasOwnProperty(a)&&"edit"!==a&&("reportFilters"===a&&(e=decodeURI(o[a])),"reportWidgets"===a&&(l=n.decode(o[a]),Object.keys(l).length)))for(s in l)r.push(l[s]);p={reportType:decodeURI(o.reportType),reportPreset:JSON.parse(o.reportPreset),reportTitle:decodeURI(o.reportTitle),reportFilters:e,reportWidgets:r},i(p)}},saveReport:function(o){var n=t.url();n=l.removeURLParameter(n,"edit"),i.onbeforeunload=null,r.post("/api/save-report-url",{report_url:n,editing_id:o}).then(function(t){i.location.href=t.data,e.log(t.data)},function(t){e.log(t.data)})},deleteReport:function(t){confirm("Delete this saved report?")&&r.post("/api/delete_post",{post_type:"Report_URL",post_id:t}).then(function(e){i.location.href=e.data,i.location.reload()},function(t){e.log(t)})},calcTimeSpent:function(t,r,i){function o(e,t){return t.some(function(t){return t.id===e})}e.log(i);for(var l=0,n=0,a=i.length;a>n;n++)(i[n][r].id===t.id||angular.isArray(i[n][r])&&o(t.id,i[n][r]))&&i[n].activity_hours&&"undefined"!=typeof i[n].activity_hours&&(l+=i[n].activity_hours);return l}}}],module.exports=[function(){var e={};return e.makeTable=function(e){},e}];
//# sourceMappingURL=maps/scripts.min.js.map
